var questions = [{'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.0, 'N/A': 0.0, 'RN': 0.25, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Social', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Social', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 1.0, 'N/A': 0.0, 'RN': 0.75, 'RY': 0.5, 'Type': 'Economic', 'Y': 0.25}, {'N': 0.25, 'N/A': 0.0, 'RN': 0.5, 'RY': 0.75, 'Type': 'Economic', 'Y': 1.0}];

var social_index = [];
var economic_index = [];

for(var i = 0; i<questions.length; i++){
  if(questions[i]['Type']=="Social"){
    social_index.push(i);
  }
  else{
    economic_index.push(i);
  }
}

var parties = [{'CP': 'N', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'RY', 'IND': 'N', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'RN', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'RN', 'DAB': 'N', 'IND': 'N/A', 'LP': 'N/A', 'TYPE': 'Social'}, {'CP': 'N/A', 'DAB': 'N', 'IND': 'N', 'LP': 'N/A', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'N', 'LP': 'N/A', 'TYPE': 'Social'}, {'CP': 'RY', 'DAB': 'N', 'IND': 'Y', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'RY', 'DAB': 'N', 'IND': 'N/A', 'LP': 'N/A', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'RY', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'Y', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'RY', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N/A', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N/A', 'DAB': 'N/A', 'IND': 'Y', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'N/A', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'N', 'IND': 'N/A', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'N', 'LP': 'N', 'TYPE': 'Social'}, {'CP': 'Y', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Social'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N/A', 'DAB': 'N/A', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'N/A', 'IND': 'N/A', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'N/A', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N', 'IND': 'N/A', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'N/A', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'Y', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'Y', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N', 'LP': 'RY', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N/A', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N/A', 'DAB': 'Y', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'N/A', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'N/A', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'Y', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N', 'DAB': 'Y', 'IND': 'N/A', 'LP': 'Y', 'TYPE': 'Economic'}, {'CP': 'Y', 'DAB': 'N', 'IND': 'Y', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N/A', 'DAB': 'Y', 'IND': 'N', 'LP': 'N', 'TYPE': 'Economic'}, {'CP': 'N/A', 'DAB': 'Y', 'IND': 'N', 'LP': 'Y', 'TYPE': 'Economic'}];

var party_names = ["DAB", "CP", "LP", "IND"];

var you = ["N", "Y", "N", "Y", "RN", "RY", "Y", "Y", "RN", "Y", "RN", "N", "Y", "RN", "N", "RN", "RY", "RN", "RN", "RN", "RN", "RN", "RN", "RY", "N", "RY", "N", "Y", "RN", "N/A", "Y", "RY", "RY", "N/A", "RY", "RN", "RN", "RN", "RY", "Y", "Y", "RY", "N", "N", "N", "N", "RN", "RN", "N/A", "Y"];
var weight = [3, 4, 1, 1, 2, 3, 4, 1, 4, 1, 4, 4, 1, 2, 3, 2, 2, 1, 4, 2, 1, 3, 2, 1, 1, 1, 4, 2, 1, 4, 3, 2, 2, 1, 4, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 3, 3, 1, 1, 1];

var calculate_position = function (choices, weight){
  var eco_weight = 0.0;
  var soc_weight = 0.0;
  
  var eco_sum = 0.0;
  var soc_sum = 0.0;
  for(var i=0; i<social_index.length; i++){
    var index = social_index[i]
    soc_sum += questions[index][choices[index]]*weight[index];
    soc_weight += weight[index];
  }
  for(var i=0; i<economic_index.length; i++){
    var index = economic_index[i];
    eco_sum += questions[index][choices[index]]*weight[index];
    eco_weight += weight[index];
  }
  eco_sum /= eco_weight;
  soc_sum /= soc_weight;
  return [eco_sum, soc_sum];
};

var party_position = function (){
  var positions = {};
  for(var j=0; j<party_names.length; j++){
    var party = party_names[j];
    var eco_sum = 0.0;
    var soc_sum = 0.0;
    for(var i=0; i<social_index.length; i++){
      var index = social_index[i];
      soc_sum += questions[index][parties[index][party]];
    }
    for(var i=0; i<economic_index.length; i++){
      var index = economic_index[i];
      eco_sum += questions[index][parties[index][party]];
    }
    
    positions[party] = [eco_sum/economic_index.length, soc_sum/social_index.length];
  }
  return positions
}

// To return a score, run score(you, party_position(), weight, score="Euclidean")
var cal_score = function(choices, party_pos, weight, score) {
  var my_position = calculate_position(choices, weight);
  party_scores = {};
  
  if( score=="Euclidean") {
    for(var i=0; i<party_names.length; i++){
      var party = party_names[i];
      var party_score = 0.0;
      party_score += Math.pow(party_pos[party][0]-my_position[0], 2) + Math.pow(party_pos[party][1]-my_position[1], 2);
      party_scores[party] = (1-party_score>=0? 1-party_score : 0);
    }
  }
  else if( score=="Norm1") {
    for(var i=0; i<party_names.length; i++){
      var party = party_names[i];
      var party_score = 0.0;
      var weight_sum = 0.0;
      for(var j=0; j<questions.length; j++){
        party_score += weight[j]*Math.abs(questions[j][parties[j][party]]-questions[j][choices[j]]);
        weight_sum += weight[j];
      }
      party_scores[party] = 1-party_score/weight_sum;
    }
  } 
  else{
    for(var i=0; i<party_names.length; i++){
      var party = party_names[i];
      var party_score = 0.0;
      var weight_sum = 0.0;
      for(var j=0; j<questions.length; j++){
        party_score += weight[j]*Math.abs(questions[j][parties[j][party]]-questions[j][choices[j]])/(0.5+Math.abs(questions[j][choices[j]]-0.5));
        weight_sum += weight[j];
      }
      party_scores[party] = 1-party_score/weight_sum;
    }
  } 

  return party_scores
}

cal_score(you, party_position(), weight, "Euclidean")

